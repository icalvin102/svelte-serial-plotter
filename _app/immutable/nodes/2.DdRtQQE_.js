import{l as ye,h as U,n as ve,g as ee,i as de,p as Me,o as Se,q as se,r as Ee,v as Q,a as Y,t as $,e as L,d as B,b as Ae,$ as te,c as De,f as Oe}from"../chunks/disclose-version.CXrSO0el.js";import{z as He,w as Fe,H as Ne,A as qe,Q as Be,B as Te,D as Le,E as ze,a1 as Ve,i as J,d as Ye,a2 as K,s as P,a3 as le,a4 as ae,m as Ue,v as z,a5 as $e,a6 as ke,a7 as We,a8 as Xe,l as Ge,S as Ke,a9 as Je,aa as Qe,ab as Ze,ac as je,ad as et,e as tt,y as _e,ae as rt,af as at,j as W,p as ue,k as ce,ag as O,g}from"../chunks/runtime.DboeV76f.js";import{p as q,o as fe,a as nt,r as ot,c as it,b as st,i as lt}from"../chunks/index-client.Bpi_UXfV.js";let re=null;function ge(e,t){return t}function ut(e,t,r){for(var o=[],n=e.length,a=0;a<n;a++)$e(e[a].e,o,!0);if(n>0&&o.length===0&&t!==null){var i=t.parentNode;Se(i),i.append(t)}ke(o,()=>{for(var h=0;h<n;h++)We(e[h].e);r!==void 0&&r()})}function ne(e,t,r,o,n,a=null){var i={flags:t,items:new Map,next:null};{var h=e;e=U?ve(h.firstChild):h.appendChild(ye())}var b=null;He(()=>{var x=r(),y=Fe(x)?x:x==null?[]:Array.from(x),v=y.length,d=i.flags;d&ae&&!Ge(y)&&!(Ke in y)&&(d^=ae,d&Je&&!(d&K)&&(d^=K));let l=!1;if(U){var u=e.data===Ne;u!==(v===0)&&(qe(de),ee(!1),l=!0)}if(U){for(var s=de[0],w=i,C,A=0;A<v;A++){if(s.nodeType!==8||s.data!==Be){l=!0,ee(!1);break}var _=s;s=ve(s);var m=y[A],H=o(m,A);C=Ce(_,s,w,null,m,H,A,n,d),i.items.set(H,C),s=s.nextSibling,w=C}if(v>0)for(;s!==e;){var F=s.nextSibling;s.remove(),s=F}}U||ct(y,i,e,n,d,o),a!==null&&(v===0?b?Te(b):b=Le(()=>a(e)):b!==null&&ze(b,()=>{b=null})),l&&ee(!0)})}function ct(e,t,r,o,n,a){var I,N,f,c;var i=(n&Xe)!==0,h=(n&(K|le))!==0,b=e.length,x=t.items,y=t.next,v=y,d=new Set,l=t,u=new Set,s=[],w=[],C,A,_,m;if(i)for(m=0;m<b;m+=1)C=e[m],A=a(C,m),_=x.get(A),_!==void 0&&((I=_.a)==null||I.measure(),u.add(_));for(m=0;m<b;m+=1){if(C=e[m],A=a(C,m),_=x.get(A),_===void 0){var H=Me(ye()),F=v?v.o:r;F.before(H),l=Ce(H,F,l,l.next,C,A,m,o,n),x.set(A,l),s=[],w=[],v=l.next;continue}if(h&&ft(_,C,m,n),_.e.f&Ve&&(Te(_.e),i&&((N=_.a)==null||N.unfix(),u.delete(_))),_!==v){if(d.has(_)){if(s.length<w.length){var M=w[0],D;l=M.prev;var V=s[0],p=s[s.length-1];for(D=0;D<s.length;D+=1)he(s[D],M,r);for(D=0;D<w.length;D+=1)d.delete(w[D]);k(V.prev,p.next),k(l,V),k(p,M),v=M,l=p,m-=1,s=[],w=[]}else d.delete(_),he(_,v,r),k(_.prev,_.next),k(_,l.next),k(l,_),l=_;continue}for(s=[],w=[];v!==null&&v.k!==A;)d.add(v),w.push(v),v=v.next;if(v===null)continue;_=v}s.push(_),l=_,v=_.next}const T=Array.from(d);for(;v;)T.push(v),v=v.next;var R=n&Qe&&b===0?r:null;if(i){for(m=0;m<T.length;m+=1)(f=T[m].a)==null||f.measure();for(m=0;m<T.length;m+=1)(c=T[m].a)==null||c.fix()}ut(T,R,()=>{for(var S=0;S<T.length;S+=1){var E=T[S];x.delete(E.k),k(E.prev,E.next)}}),i&&J(()=>{Ye(()=>{var S;for(_ of u)(S=_.a)==null||S.apply()})})}function ft(e,t,r,o){o&K&&P(e.v,t),o&le?P(e.i,r):e.i=r}function Ce(e,t,r,o,n,a,i,h,b){var x=re;try{var y=(b&K)!==0,v=(b&ae)===0,d=y?v?Ue(n):z(n):n,l=b&le?z(i):i,u={i:l,v:d,k:a,a:null,e:null,o:e,prev:r,next:o};return r.next=u,o!==null&&(o.prev=u),re=u,u.e=Le(()=>h(t,d,l)),u}finally{re=x}}function he(e,t,r){for(var o=e.next?e.next.o:r,n=t?t.o:r,a=e.o;a!==o;){var i=a.nextSibling;n.before(a),a=i}}function k(e,t){e.next=t,t!==null&&(t.prev=e)}function vt(e,t){if(t){const r=document.body;e.autofocus=!0,J(()=>{document.activeElement===r&&e.focus()})}}function dt(e){U&&e.firstChild!==null&&Se(e)}function oe(e){if(U){const t=e.getAttribute("value");ie(e,"value",null),ie(e,"checked",null),t&&(e.value=t)}}function ie(e,t,r){r=r==null?null:r+"";var o=e.__attributes??(e.__attributes={});U&&(o[t]=e.getAttribute(t),t==="src"||t==="href"||t==="srcset")||o[t]!==(o[t]=r)&&(r===null?e.removeAttribute(t):e.setAttribute(t,r))}function _t(e,t,r,o,n){var a=n.length!==0;for(var i in t)i in r||(r[i]=null);a&&!r.class&&(r.class="");var h=Ze(me,e.nodeName);h||je(me,e.nodeName,h=ht(e));var b=e.__attributes??(e.__attributes={}),x=[];for(i in r){let l=r[i];if(l!==(t==null?void 0:t[i])){var y=i[0]+i[1];if(y!=="$$")if(y==="on"){const u={};let s=i.slice(2);var v=rt.includes(s);s.endsWith("capture")&&s!=="ongotpointercapture"&&s!=="onlostpointercapture"&&(s=s.slice(0,-7),u.capture=!0),!v&&(t!=null&&t[i])&&e.removeEventListener(s,t[i],u),l!=null&&(v?(e[`__${s}`]=l,se([s])):t?e.addEventListener(s,l,u):x.push(()=>e.addEventListener(s,l,u)))}else if(l==null)b[i]=null,e.removeAttribute(i);else if(i==="style")e.style.cssText=l+"";else if(i==="autofocus")vt(e,!!l);else if(i==="__value"||i==="value")e.value=e[i]=e.__value=l;else{var d=i;d=d.toLowerCase(),d=et[d]||d,h.includes(d)?U&&(d==="src"||d==="href"||d==="srcset")||(e[d]=l):typeof l!="function"&&(a&&d==="class"&&(l&&(l+=" "),l+=n),ie(e,d,l))}}}return t||J(()=>x.forEach(tt)),r}var gt=["width","height"],me=new Map;function ht(e){for(var t=[],r,o=_e(e);o.constructor.name!=="Element";){r=at(o);for(var n in r)r[n].set&&!gt.includes(n)&&t.push(n);o=_e(o)}return t}let pe=!1;function Pe(e,t,r,o=r){e.addEventListener(t,r);const n=e.__on_r;n?e.__on_r=()=>{n(),o()}:e.__on_r=o,pe||(pe=!0,document.addEventListener("reset",a=>{Promise.resolve().then(()=>{var i;if(!a.defaultPrevented)for(const h of a.target.elements)(i=h.__on_r)==null||i.call(h)})},{capture:!0}))}function mt(e,t,r){Pe(e,"input",()=>{r(be(e)?xe(e.value):e.value)}),W(()=>{var o=t();e.__value=o,!(be(e)&&o===xe(e.value))&&(e.type==="date"&&!o&&!e.value||(e.value=Ee(o)))})}function be(e){var t=e.type;return t==="number"||t==="range"}function xe(e){return e===""?null:+e}function Ie(e,t,r){if(e.multiple)return bt(e,t);for(var o of e.options){var n=G(o);if(n===t){o.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function pt(e,t){J(()=>{var r=new MutationObserver(()=>{var o=e.__value;Ie(e,o)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function we(e,t,r){var o=!0;Pe(e,"change",()=>{var n;if(e.multiple)n=[].map.call(e.querySelectorAll(":checked"),G);else{var a=e.querySelector(":checked");n=a&&G(a)}r(n)}),J(()=>{var n=t();if(Ie(e,n,o),o&&n===void 0){var a=e.querySelector(":checked");a!==null&&(n=G(a),r(n))}e.__value=n,o=!1}),pt(e)}function bt(e,t){for(var r of e.options)r.selected=~t.indexOf(G(r))}function G(e){return"__value"in e?e.__value:e.value}var xt=(e,t,r)=>t(O(r)),wt=(e,t,r)=>t(O(r)),yt=$('<li class="command-item svelte-qijugo"><span> </span> <div class="command-buttons svelte-qijugo"><button class="icon-button svelte-qijugo" title="Edit"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M5 19h1.425L16.2 9.225L14.775 7.8L5 17.575z"></path></svg></button> <button class="icon-button svelte-qijugo" title="Run"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="m9.5 16.5l7-4.5l-7-4.5zM12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m0-8"></path></svg></button> <button class="icon-button svelte-qijugo" title="Delete"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zM17 6H7v13h10zM9 17h2V8H9zm4 0h2V8h-2zM7 6v13z"></path></svg></button></div></li>'),St=$('<div class="mx-auto flex w-full flex-col rounded-md bg-gray-900 p-4 font-mono text-xs text-white"><ul class="command-list mb-2 flex-grow space-y-1 overflow-y-auto"></ul> <form class="flex"><input type="text" placeholder="Type a command and press Enter" class="flex-1 rounded-md bg-gray-800 p-2 text-white outline-none"></form></div>');function Et(e,t){ue(t,!0);const r="serialCommandHistory";let o=z(""),n=z(q([]));const a={read(){const u=localStorage.getItem(r);u&&P(n,q(JSON.parse(u)))},write(u){localStorage.setItem(r,JSON.stringify(u))},clear(){localStorage.removeItem(r)}};fe(()=>{a.read()});function i(u){u.preventDefault(),g(o).trim()&&(g(n).indexOf(g(o))<0&&(g(n).push(g(o)),a.write(g(n))),t.onSubmit(g(o)))}function h(u){P(o,q(u))}function b(u){P(o,q(u)),i(new Event("submit"))}function x(u){P(n,q(g(n).filter((s,w)=>w!==u))),a.write(g(n))}var y=St(),v=B(y);ne(v,73,()=>g(n),(u,s)=>O(s),(u,s,w)=>{var C=yt(),A=B(C),_=B(A),m=L(L(A,!0)),H=B(m);H.__click=[xt,h,s];var F=L(L(H,!0));F.__click=[wt,b,s];var M=L(L(F,!0));M.__click=()=>x(O(w)),W(()=>Ae(_,O(s))),Y(u,C)});var d=L(L(v,!0)),l=B(d);oe(l),Q("submit",d,i,!1),mt(l,()=>g(o),u=>P(o,u)),Y(e,y),ce()}se(["click"]);var At=$("<canvas></canvas>");function Tt(e,t){ue(t,!0);let r=nt(t,"lines",11,()=>[]),o=ot(t,["lines"]),n=z(void 0),a=null,i=null,h=null,b=[],x;fe(()=>{if(!g(n))return;if(a=g(n).getContext("webgl2"),!a){alert("WebGL 2.0 is not supported on your browser!");return}const p=`#version 300 es
            precision highp float;

            in vec2 aVertexPosition;
            uniform mat3 uTransform;
            void main(void) {
                vec3 pos = vec3(aVertexPosition, 1.0);
                gl_Position = vec4(uTransform * pos, 1.0);
            }
        `,T=`#version 300 es
            precision highp float;

            out vec4 fragColor;
            uniform vec4 uColor;
            void main(void) {
                fragColor = uColor;
            }
        `;function R(N,f){if(!a)return null;const c=a.createShader(N);return c?(a.shaderSource(c,f),a.compileShader(c),a.getShaderParameter(c,a.COMPILE_STATUS)?c:(console.error("Error compiling shader:",a.getShaderInfoLog(c)),a.deleteShader(c),null)):null}function I(N,f){const c=R(a.VERTEX_SHADER,N),S=R(a.FRAGMENT_SHADER,f);if(!c||!S)return null;const E=a.createProgram();return E?(a.attachShader(E,c),a.attachShader(E,S),a.linkProgram(E),a.getProgramParameter(E,a.LINK_STATUS)?E:(console.error("Unable to initialize the shader program:",a.getProgramInfoLog(E)),null)):null}i=I(p,T),i&&(h={program:i,attribLocations:{vertexPosition:a.getAttribLocation(i,"aVertexPosition")},uniformLocations:{transform:a.getUniformLocation(i,"uTransform"),color:a.getUniformLocation(i,"uColor")}},y(),v())}),it(()=>{cancelAnimationFrame(x)});function y(){g(n)&&(g(n).width=g(n).clientWidth,g(n).height=g(n).clientHeight,a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight))}function v(){a.clear(a.COLOR_BUFFER_BIT),a.useProgram(h.program),a.uniformMatrix3fv(h.uniformLocations.transform,!1,m()),r().forEach((p,T)=>{const R=b[T]||(b[T]=a.createBuffer()),{data:I}=p,N=new Float32Array(I.length*2);for(let f=0;f<I.length;f++)N[f*2]=(f/I.length-.5)*2,N[f*2+1]=I[f];a.bindBuffer(a.ARRAY_BUFFER,R),a.bufferData(a.ARRAY_BUFFER,N,a.DYNAMIC_DRAW),a.uniform4fv(h.uniformLocations.color,p.color),a.vertexAttribPointer(h.attribLocations.vertexPosition,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(h.attribLocations.vertexPosition),a.drawArrays(a.LINE_STRIP,0,I.length)}),x=requestAnimationFrame(v)}let d={x:1,y:1},l={x:0,y:0},u={x:0,y:0},s={x:0,y:0},w={x:0,y:0},C=!1;function A(p){const T=(p.clientX-u.x)/(g(n).clientWidth*.5),R=(p.clientY-u.y)/(g(n).clientHeight*.5);s={x:T,y:R}}function _(p){const R=(p.clientX-u.x)*.002,I=(p.clientY-u.y)*.002;w={x:R,y:I}}function m(){const p=d.x+w.x,T=d.y-w.y,R=l.x+s.x,I=l.y-s.y;return new Float32Array([p,0,0,0,T,0,R,I,1])}function H(p){u.x=p.clientX,u.y=p.clientY,A(p),_(p),C=!0}function F(p){!C||!g(n)||(p.preventDefault(),p.shiftKey?_(p):A(p))}function M(){l.x+=s.x,l.y-=s.y,s={x:0,y:0},d.x+=w.x,d.y-=w.y,w={x:0,y:0},C=!1}var D=At();Q("resize",te,y,!1),Q("mousemove",te,F,!1),Q("mouseup",te,M,!1),st(D,p=>P(n,q(p)),()=>g(n));let V;W(()=>V=_t(D,V,{...o,onmousedown:H},!0,"")),Y(e,D),ce()}function Z(){return{data:[],color:[Math.random(),Math.random(),Math.random(),1]}}function Re(e){return(t,r=1)=>{const o=Z();for(let n=0;n<t;n++)o.data.push(e(n*r));return o}}const Lt=Re(Math.sin),Ct=Re(Math.cos);var Pt=$("<option> </option>"),It=$("<option> </option>"),Rt=$('<button class="rounded bg-red-500 px-2 py-1 text-white">Disconnect</button>'),Mt=$('<button class="rounded bg-blue-500 px-2 py-1 text-white">Connect</button>'),Dt=$('<main class="grid grid-cols-6 gap-2 p-4"><div class="col-span-2 flex flex-col"><h1 class="mb-4 text-2xl font-bold">Serial Communication</h1> <div class="mb-2 flex w-full max-w-md flex-row items-center space-x-2"><select class="flex-1 rounded border p-1"></select> <select class="flex-1 rounded border p-1"></select> <!></div> <textarea readonly="" class="mb-auto h-48 w-full flex-grow resize-none rounded border bg-slate-900 p-2 text-xs text-white"></textarea></div> <!> <div class="col-span-full"><!></div></main>');function Ot(e,t){ue(t,!0);let r,o;const n=new TextDecoderStream;let a=z(""),i="",h=z("disconnected"),b=z(q([])),x=z(null),y=z(115200),v=z(q([Lt(200,Math.PI/100),Ct(200,Math.PI/100),Z(),Z()]));const d=[9600,14400,19200,38400,57600,115200];fe(async()=>{"serial"in navigator&&(P(b,q(await navigator.serial.getPorts())),g(b).length>0&&P(x,q(g(b)[0])))});async function l(){try{if(g(x)||P(x,q(await navigator.serial.requestPort())),r=g(x),await r.open({baudRate:g(y)}),!(r.readable&&r.writable))return;const f=r.readable.pipeTo(n.writable);o=r.writable.getWriter();const c=n.readable.getReader();C(c),P(h,"connected")}catch(f){console.error("Connection error:",f),P(h,"error")}}async function u(){if(r&&o)try{await o.close(),await r.close()}catch(f){console.error("Disconnection error:",f)}finally{o=null,r=null,P(h,"disconnected")}}function s(f){if(f.trim(),f==="clear"){P(v,q([]));return}f.split(",").map(parseFloat).filter(c=>!isNaN(c)).forEach((c,S)=>{(g(v)[S]||(g(v)[S]=Z())).data.push(c)})}function w(f){const c=`\r
`;i+=f;let S=i.indexOf(c);for(;S>=0;)s(i.slice(0,S)),i=i.slice(S+2),S=i.indexOf(c);P(a,g(a)+f)}async function C(f){try{for(;;){const{value:c,done:S}=await f.read();if(S){f.releaseLock();break}w(c)}}catch(c){console.error("Read error:",c)}}async function A(f){const c=f+`
`;o&&await o.write(new TextEncoder().encode(c))}var _=Dt(),m=B(_),H=B(m),F=L(L(H,!0)),M=B(F);oe(M),ne(M,73,()=>g(b),ge,(f,c,S)=>{var E=Pt(),X,j=B(E);j.nodeValue=Ee(`Port ${O(S)+1}`),W(()=>{X!==(X=O(c))&&(E.value=(E.__value=O(c))==null?"":O(c))}),Y(f,E)});var V=L(L(M,!0));oe(V),ne(V,73,()=>d,ge,(f,c,S)=>{var E=It(),X,j=B(E);W(()=>{X!==(X=O(c))&&(E.value=(E.__value=O(c))==null?"":O(c)),Ae(j,O(c))}),Y(f,E)});var p=L(L(V,!0));lt(p,()=>g(h)==="connected",f=>{var c=Rt();c.__click=u,Y(f,c)},f=>{var c=Mt();c.__click=l,Y(f,c)});var T=L(L(F,!0));dt(T);var R=L(L(m,!0));Tt(R,{get lines(){return g(v)},class:"col-span-4 block h-96 w-full rounded bg-slate-900"});var I=L(L(R,!0)),N=B(I);Et(N,{onSubmit:A}),W(()=>T.value=g(a)),we(M,()=>g(x),f=>P(x,f)),we(V,()=>g(y),f=>P(y,f)),Y(e,_),ce()}se(["click"]);function qt(e){var t=De(),r=Oe(t);Ot(r,{}),Y(e,t)}export{qt as component};
